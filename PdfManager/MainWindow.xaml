<Window
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PdfManager"
        xmlns:Data="clr-namespace:PdfManager.Data" x:Class="PdfManager.MainWindow"
        mc:Ignorable="d"
        Title="成都电力机械厂PDF文档管理系统" Height="480" Width="800" Loaded="Window_Loaded" MinWidth="600" MinHeight="400" WindowStartupLocation="CenterScreen" WindowState="Maximized">
    <Window.Resources>
        <CollectionViewSource x:Key="pdfFileViewSource" d:DesignSource="{d:DesignInstance {x:Type Data:PdfFile}, CreateList=True}"/>
        <!--<Data:PdfSearchResult x:Key="SearchResult"/>-->
        <Style x:Key="BlackIconStyle" TargetType="Image">
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
            <Setter Property="Width" Value="16"/>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1.5" ScaleY="1.5"/>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="BlackMenuItem" TargetType="MenuItem">
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.5"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <Window.CommandBindings>
        <CommandBinding Command="ApplicationCommands.New" Executed="New_Executed" CanExecute="True_CanExecute"/>
        <CommandBinding Command="ApplicationCommands.Find" Executed="Find_Executed" CanExecute="Find_CanExecute"/>
        <CommandBinding Command="ApplicationCommands.Delete" Executed="Delete_Executed" CanExecute="Delete_CanExecute"/>
    </Window.CommandBindings>
    <Grid>
        <DockPanel>
            <Menu DockPanel.Dock="Top">
                <MenuItem x:Name="btnSearch" Command="ApplicationCommands.New" Style="{DynamicResource BlackMenuItem}">
                    <MenuItem.Icon>
                        <Image Source="black/Add.png" Style="{DynamicResource BlackIconStyle}"/>
                    </MenuItem.Icon>
                    <MenuItem.Header>
                        <TextBlock VerticalAlignment="Center">添加</TextBlock>
                    </MenuItem.Header>
                </MenuItem>
                <StackPanel Orientation="Horizontal">
                    <Image Source="black/Find.png" Style="{DynamicResource BlackIconStyle}"/>
                    <TextBox x:Name="txtKeyword" Width="100" MaxLength="20" Margin="3,0,0,0"/>
                </StackPanel>
                <MenuItem x:Name="btnNew" Command="ApplicationCommands.Find" Style="{DynamicResource BlackMenuItem}">
                    <MenuItem.Header>
                        <TextBlock VerticalAlignment="Center">查找</TextBlock>
                    </MenuItem.Header>
                </MenuItem>
                <MenuItem x:Name="btnDelete" Command="ApplicationCommands.Delete" Style="{DynamicResource BlackMenuItem}">
                    <MenuItem.Icon>
                        <Image Source="black/Delete.png" Style="{DynamicResource BlackIconStyle}"/>
                    </MenuItem.Icon>
                    <MenuItem.Header>
                        <TextBlock VerticalAlignment="Center">删除</TextBlock>
                    </MenuItem.Header>
                </MenuItem>
            </Menu>
            <TreeView x:Name="trvResult"  Width="150" VerticalContentAlignment="Stretch" SelectedItemChanged="trvResult_SelectedItemChanged">
                <TreeView.CommandBindings>
                    <CommandBinding Command="MediaCommands.Select" CanExecute="CommandBinding_CanExecute" Executed="CommandBinding_Executed"/>
                </TreeView.CommandBindings>
                <TreeView.DataContext>
                    <Data:PdfSearchResult/>
                </TreeView.DataContext>
                <TreeViewItem Header="标题" ItemsSource="{Binding ByTittle}" IsExpanded="True">
                    <TreeViewItem.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Tittle}" >
                            </TextBlock>
                        </DataTemplate>
                    </TreeViewItem.ItemTemplate>
                </TreeViewItem>
                <TreeViewItem Header="文件号" ItemsSource="{Binding ByNumber}" IsExpanded="True">
                    <TreeViewItem.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding Tittle}" />
                                <TextBlock Text="{Binding FileId}" FontStyle="Italic" FontSize="10" />
                            </StackPanel>
                        </DataTemplate>
                    </TreeViewItem.ItemTemplate>
                </TreeViewItem>
                <TreeViewItem Header="年号" ItemsSource="{Binding ByYear}" IsExpanded="True">
                    <TreeViewItem.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding Tittle}" />
                                <TextBlock Text="{Binding Year}" FontStyle="Italic" FontSize="10" />
                            </StackPanel>
                        </DataTemplate>
                    </TreeViewItem.ItemTemplate>
                </TreeViewItem>
                <TreeViewItem Header="{DynamicResource Other1Name}" ItemsSource="{Binding ByOther1}" IsExpanded="True">
                    <TreeViewItem.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding Tittle}" />
                                <TextBlock Text="{Binding Other1}" FontStyle="Italic" FontSize="10" />
                            </StackPanel>
                        </DataTemplate>
                    </TreeViewItem.ItemTemplate>
                </TreeViewItem>
                <TreeViewItem Header="{DynamicResource Other2Name}" ItemsSource="{Binding ByOther2}" IsExpanded="True">
                    <TreeViewItem.ItemTemplate>
                        <DataTemplate>
                            <StackPanel>
                                <TextBlock Text="{Binding Tittle}" />
                                <TextBlock Text="{Binding Other2}" FontStyle="Italic" FontSize="10" />
                            </StackPanel>
                        </DataTemplate>
                    </TreeViewItem.ItemTemplate>
                </TreeViewItem>
            </TreeView>
            <WindowsFormsHost x:Name="winfromHost" />
        </DockPanel>
    </Grid>
</Window>